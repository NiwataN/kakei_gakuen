<% provide(:title, "着せ替え") %>
<div class="container">
  <br><div class="btn btn-default" onclick="build_json();">決定</div>


  <div id="Closets" class="row box" style="padding-bottom: 0px;">
    <!-- カテゴリアイテム一覧 -->
    <div id="ClosetsItems" class="col-xs-4">
      <% @send_clothes.each do |key, val| %>
        <% val.each do |obj| %>
          <% unless obj.nil? %>
            <div class="col-md-6 col-sm-12">
              <div class="ItemBox" onclick="draw_image('<%= key %>', '<%= obj.image %>', <%= obj.priority %>, <%= obj.id %>);">
                <%= image_tag obj.image %>
              </div>
            </div>
          <% end %>
        <% end %>
        <% break %>
      <% end %>
    </div>
    <!-- キャラクタ表示領域 -->
    <div id="ClosetsCharactor" class="col-xs-8" style="background-image:url(<%= asset_path 'closet-img.jpg' %>);">
      <!-- レイヤ描画 -->
      <% @send_clothes.each do |key, val| %>
        <div id="<%= key %>" class="Layers">
          <div id="<%= key %>-id" style="display:none;"></div>
        </div>
      <% end%>
      <!-- 現在のキャラクタ描画 -->
      <% @send_user_wearing_clothes.each do |key, val| %>
        <% val.each do |obj| %>
          <% unless obj.nil? %>
            <script>draw_image('<%= key %>', '<%= obj.image %>', <%= obj.priority %>, <%= obj.id %>);</script>
          <% end %>
        <% end %>
      <% end %>
    </div>
    <!-- カテゴリ一覧 -->
    <div id="ClosetsItemGroups" class="col-xs-12" style="display:none;">
      <% @send_clothes.each do |key, val| %>
        <% hash = Hash.new { |h,k| h[k] = {} } %>
        <% val.each do |obj| %>
          <% unless obj.nil? %>
            <% hash[obj.id]['id'] = obj.id %>
            <% hash[obj.id]['category'] = key %>
            <% hash[obj.id]['path'] = obj.image.to_s %>
            <% hash[obj.id]['priority'] = obj.priority %>
          <% end %>
        <% end %>
        <div id="<%= key %>-group" class="GroupBox" data-hoge="<%= hash.to_json %>" onclick="switch_items('<%= key %>');">
          <%= key %>
        </div>
      <% end %>
    </div>
  </div>
  <div class="btn btn-default" style="margin-bottom: 15px;" onclick="build_json();">決定</div>
</div>
